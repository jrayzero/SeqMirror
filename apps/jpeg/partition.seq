from cola.ptree import *

# partitions into row-major MxN blocks
def MxN_partition_rmaj[M: int, N: int, T](data: View[T]) -> PTree[T]:
  ptree = PTree(data)
  pt_build ptree:
    pt_and:
      for r in range(0, data.dims()[0], M):
        for c in range(0, data.dims()[1], N):
          pt_leaf data[r:r+M,c:c+N]
  return ptree

def NxN_partition_rmaj[N: int, T](data: View[T]) -> PTree[T]:
  return MxN_partition_rmaj[N,N,T](data)
      
