from cola.block import *

blk = Block[int](5,5)
print(blk.dims())
print(blk.nunits())
print(blk.base.buffer)
print(blk.base.buffer_mapping)
print(blk)

l = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]
blk2 = Block[int]([5,3], l)
print(blk2)
assert blk2.base.buffer_equals(l)
l = [0,3,6,9,12]
assert blk2[:,0].base.buffer_equals(l)
l = [1,4,7,10,13]
assert blk2[:,1].base.buffer_equals(l)
l = [2,5,8,11,14]
assert blk2[:,2].base.buffer_equals(l)
l = [0,2,3,5,6,8,9,11,12,14]
print(blk2[:,::2])
print(blk2[:,::2].dims())
assert blk2[:,::2].base.buffer_equals(l)

print(blk2[:,0].elide_back())
print(blk2[:,1].elide_back())
print(blk2[:,2].elide_back())

blk3 = Block[int]([3,5], [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])

print(blk3[0,:].elide_front())
print(blk3[1,:].elide_front())
print(blk3[2,:].elide_front())
print(blk3[2,3].elide_front())
l = [0,2,4,10,12,14]
assert blk3[::2,::2].base.buffer_equals(l)
assert blk3[1,1]() == 6
assert blk3[::2,::2][1,1]() == 12
assert blk3[::2,::2](1,1) == 12
#print(blk3[1,1]())
#print(blk3[::2,::2][1,1])

print(blk3)
print(blk3[::2,::3])
for b in blk3[::2,::3]:
    print(b())
